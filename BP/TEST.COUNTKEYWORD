OPEN "BP" TO F.BP ELSE STOP
READ SRC FROM F.BP, "CREATEDIFFS" ELSE STOP
SRC.LINES = DCOUNT( SRC, @FM )
CC = 1
FOR I = 1 TO SRC.LINES
    LINE = SRC<I>
    CALL COUNTKEYWORD( CNT, "THEN", LINE )
    CC += CNT
    CALL COUNTKEYWORD( CNT, "ELSE", LINE )
    CC += CNT
    CALL COUNTKEYWORD( CNT, "CASE", LINE )
    CC += CNT
    CALL COUNTKEYWORD( CNT, "BEGIN CASE", LINE )
    CC -= CNT
    CALL COUNTKEYWORD( CNT, "END CASE", LINE )
    CC -= CNT
    CALL COUNTKEYWORD( CNT, "FOR", LINE )
    CC += CNT
    CALL COUNTKEYWORD( CNT, "WHILE", LINE )
    CC += CNT
    CALL COUNTKEYWORD( CNT, "UNTIL", LINE )
    CC += CNT
NEXT I
CRT "Cyclomatic Complexity = " : CC
END
